!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("rxjs")):"function"==typeof define&&define.amd?define("ngx-simple-modal",["exports","@angular/common","@angular/core","rxjs"],t):t((e=e||self)["ngx-simple-modal"]={},e.ng.common,e.ng.core,e.rxjs)}(this,(function(e,t,o,n){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function r(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a}function i(e,t){return function(o,n){t(o,n,e)}}function a(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}var l=new o.InjectionToken("default-simple-modal.config"),c={closeOnEscape:!1,closeOnClickOutside:!1,bodyClass:"modal-open",wrapperDefaultClasses:"modal fade-anim",wrapperClass:"in",animationDuration:300,autoFocus:!1},p=function(){function e(e){this.resolver=e,this.modalClasses="modal fade-anim"}return e.prototype.addComponent=function(e){var t=this.resolver.resolveComponentFactory(e),n=o.ReflectiveInjector.fromResolvedProviders([],this.viewContainer.injector),r=t.create(n);return this.viewContainer.insert(r.hostView),this.content=r.instance,this.content.wrapper=this.wrapper,this.content},e.prototype.onClickOutsideModalContent=function(e){var t=this.wrapper.nativeElement;this.clickOutsideCallback=function(o){o.target===t&&e()},t.addEventListener("click",this.clickOutsideCallback,!1)},e.prototype.ngOnDestroy=function(){this.clickOutsideCallback&&(this.wrapper.nativeElement.removeEventListener("click",this.clickOutsideCallback,!1),this.clickOutsideCallback=null)},e.ctorParameters=function(){return[{type:o.ComponentFactoryResolver}]},r([o.ViewChild("viewContainer",{read:o.ViewContainerRef,static:!0})],e.prototype,"viewContainer",void 0),r([o.ViewChild("wrapper",{read:o.ElementRef,static:!0})],e.prototype,"wrapper",void 0),e=r([o.Component({selector:"simple-modal-wrapper",template:'\n    <div #wrapper [ngClass]="modalClasses" [ngStyle]="{ display: \'block\' }" role="dialog">\n      <ng-template #viewContainer></ng-template>\n    </div>\n  '})],e)}(),u=function(){function e(e,t){this.resolver=e,this.defaultSimpleModalOptions=t,this.modals=[],this.previousActiveElement=null}return e.prototype.addModal=function(e,t,o){var r=this;if(!this.viewContainer)return n.of(null);var i=this.resolver.resolveComponentFactory(p),a=this.viewContainer.createComponent(i).instance,s=a.addComponent(e);return s.options=o=Object.assign({},this.defaultSimpleModalOptions,o),a.modalClasses=o.wrapperDefaultClasses,this.modals.push(s),this.wait().then((function(){r.toggleWrapperClass(a.wrapper,o.wrapperClass),r.toggleBodyClass(o.bodyClass),r.wait(o.animationDuration).then((function(){r.autoFocusFirstElement(s.wrapper,o.autoFocus),s.markAsReady()}))})),s.onClosing((function(e){return r.removeModal(e)})),this.configureCloseOnClickOutside(a),s.mapDataObject(t),s.setupObserver()},e.prototype.removeModal=function(e){var t=this,o=e.options;return this.toggleWrapperClass(e.wrapper,o.wrapperClass),this.wait(o.animationDuration).then((function(){t.removeModalFromArray(e),t.toggleBodyClass(o.bodyClass),t.restorePreviousFocus()}))},e.prototype.removeAllModals=function(){var e=this;return Promise.all(this.modals.map((function(t){return e.removeModal(t)})))},e.prototype.toggleBodyClass=function(e){var t,o;if(e){var n=document.getElementsByTagName("body")[0],r=e.split(" ");this.modals.length?(o=n.classList).add.apply(o,s(r)):(t=n.classList).remove.apply(t,s(r))}},e.prototype.configureCloseOnClickOutside=function(e){e.content.options.closeOnClickOutside&&e.onClickOutsideModalContent((function(){e.content.close()}))},e.prototype.autoFocusFirstElement=function(e,t){if(t){var o=e.nativeElement.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');o&&o.length&&(this.previousActiveElement=document.activeElement,o[0].focus())}},e.prototype.restorePreviousFocus=function(){this.previousActiveElement&&(this.previousActiveElement.focus(),this.previousActiveElement=null)},e.prototype.toggleWrapperClass=function(e,t){var o=e.nativeElement.classList,n=t.split(" ");-1!==o.toString().indexOf(t)?o.remove.apply(o,s(n)):o.add.apply(o,s(n))},e.prototype.wait=function(e){return void 0===e&&(e=0),new Promise((function(t,o){setTimeout((function(){return t()}),e)}))},e.prototype.removeModalFromArray=function(e){var t=this.modals.indexOf(e);t>-1&&(this.viewContainer.remove(t),this.modals.splice(t,1))},e.ctorParameters=function(){return[{type:o.ComponentFactoryResolver},{type:void 0,decorators:[{type:o.Inject,args:[l]}]}]},r([o.ViewChild("viewContainer",{read:o.ViewContainerRef,static:!0})],e.prototype,"viewContainer",void 0),e=r([o.Component({selector:"simple-modal-holder",template:"<ng-template #viewContainer></ng-template>"}),i(1,o.Inject(l))],e)}(),d=function(){this.container=null},m=function(){function e(e,t,o,n){this.resolver=e,this.applicationRef=t,this.injector=o,n&&(this.container=n.container)}return e.prototype.addModal=function(e,t,o){return this.modalHolderComponent||(this.modalHolderComponent=this.createSimpleModalHolder()),this.modalHolderComponent.addModal(e,t,o)},e.prototype.removeModal=function(e){return this.modalHolderComponent?this.modalHolderComponent.removeModal(e):Promise.resolve({})},e.prototype.removeAll=function(){return this.modalHolderComponent?this.modalHolderComponent.removeAllModals():Promise.resolve({})},Object.defineProperty(e.prototype,"container",{get:function(){if("string"==typeof this._container&&(this._container=document.getElementById(this._container)),!this._container&&this.applicationRef.components.length){var e=this.applicationRef.components[0];this.container=e.hostView.rootNodes[0]}return this._container&&"string"!=typeof this._container||(this._container=document.getElementsByTagName("body")[0]),this._container},set:function(e){this._container=e},enumerable:!0,configurable:!0}),e.prototype.createSimpleModalHolder=function(){var e=this,t=this.resolver.resolveComponentFactory(u).create(this.injector),o=t.hostView.rootNodes[0];return this.applicationRef.attachView(t.hostView),t.onDestroy((function(){e.applicationRef.detachView(t.hostView)})),this.container.appendChild(o),t.instance},e.ctorParameters=function(){return[{type:o.ComponentFactoryResolver},{type:o.ApplicationRef},{type:o.Injector},{type:d,decorators:[{type:o.Optional}]}]},e=r([o.Injectable(),i(3,o.Optional())],e)}();function f(e,t,o,n){return new m(e,t,o,n)}var h=c,v=function(){function e(){}var n;return n=e,e.forRoot=function(e,t){return{ngModule:n,providers:[{provide:d,useValue:e},{provide:m,useFactory:f,deps:[o.ComponentFactoryResolver,o.ApplicationRef,o.Injector,d]},{provide:l,useValue:t||c}]}},e=n=r([o.NgModule({declarations:[u,p],providers:[m,{provide:l,useValue:h}],imports:[t.CommonModule],entryComponents:[u,p]})],e)}(),y=function(){function e(){this._ready$=new n.BehaviorSubject(!1),this.closerCallback=function(){return Promise.resolve()}}return e.prototype.mapDataObject=function(e){e=e||{};for(var t=Object.keys(e),o=0,n=t.length;o<n;o++){var r=t[o];e[r]&&this[r]&&"object"==typeof e[r]&&"object"==typeof this[r]?Object.assign(this[r],e[r]):this[r]=e[r]}},e.prototype.setupObserver=function(){var e=this;return n.Observable.create((function(t){return e.observer=t,function(){e.close()}}))},e.prototype.onClosing=function(e){this.closerCallback=e},e.prototype.close=function(){var e=this;return this.closerCallback(this).then((function(t){return e.observer&&(e.observer.next(e.result),e.observer.complete()),t}))},e.prototype.onKeydownHandler=function(e){this.options&&this.options.closeOnEscape&&this.close()},Object.defineProperty(e.prototype,"ready$",{get:function(){return this._ready$.asObservable()},enumerable:!0,configurable:!0}),e.prototype.markAsReady=function(){this._ready$.next(!0)},r([o.HostListener("document:keydown.escape",["$event"])],e.prototype,"onKeydownHandler",null),e}();e.DefaultSimpleModalOptionConfig=l,e.SimpleModalComponent=y,e.SimpleModalModule=v,e.SimpleModalService=m,e.SimpleModalServiceConfig=d,e.defaultSimpleModalOptions=c,e.ɵa=u,e.ɵb=p,e.ɵc=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-simple-modal.umd.min.js.map